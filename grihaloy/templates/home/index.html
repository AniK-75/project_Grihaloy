{% extends "base.html" %}
{% block content %}

<section class="text-center py-5" style="background: linear-gradient(135deg, #3d3735, #5a514f); color: white; border-radius: 15px;">
  <div class="container py-5">
    <h1 class="display-5 fw-bold">Find Your Perfect Home</h1>
    <p class="lead mb-4">Simplifying property rentals across Bangladesh ‚Äî with trust and technology.</p>

    {% if not user.is_authenticated %}
      <a href="{% url 'users:register' %}" class="btn btn-accent btn-lg me-2">Get Started</a>
      <a href="{% url 'users:login' %}" class="btn btn-outline-light btn-lg">Login</a>
    {% else %}
       {# Use request.user instead of user for consistency #}
      <a href="{% url 'users:verification_list' %}" class="btn btn-accent btn-lg">
        {% if request.user.role == 'ADMIN' %}
          KYC Requests
        {% elif request.user.kyc_status == 'PENDING' %}
          KYC Pending Review
        {% elif request.user.kyc_status == 'REJECTED' %}
          KYC Rejected - Resubmit?
        {% elif request.user.kyc_status == 'APPROVED' %}
          KYC Verified <span style="color: gold;">‚òÖ</span> {# Example: Show verified status #}
        {% else %}
           Request KYC Verification
        {% endif %}
      </a>
    {% endif %}
  </div>
</section>

{% if top_properties %}
<section class="mt-5">
  <div class="container text-center">
    <h2 class="fw-semibold mb-4 text-brown">Top Rated Properties</h2>
    <div class="row g-4 justify-content-center">
      {% for prop in top_properties %}
      <div class="col-md-6 col-lg-4">
        <div class="card border-0 shadow-sm h-100 property-poster-card">
          <a href="{% url 'properties:detail' prop.pk %}">
            {% if prop.first_photo_url %}
              <img src="{{ MEDIA_URL }}{{ prop.first_photo_url }}" class="card-img-top" alt="{{ prop.title }}" style="height: 250px; object-fit: cover;">
              {% else %}
              <div class="d-flex align-items-center justify-content-center bg-light" style="height: 250px;">
                <span class="text-muted">No photo</span>
              </div>
            {% endif %}
          </a>
          <div class="card-body d-flex flex-column">
            <h5 class="card-title text-brown mb-1">{{ prop.title }}</h5>
            <p class="card-text text-muted small mb-2">{{ prop.area }}, {{ prop.city }}</p>
            <div class="mt-auto d-flex justify-content-between align-items-center">
               <span class="fw-semibold" style="color: var(--accent-color);">
                 ‚òÖ {{ prop.avg_rating|floatformat:1 }}
                 <span class="text-muted fw-normal small">({{ prop.total_ratings }} rating{{ prop.total_ratings|pluralize }})</span>
               </span>
               <a href="{% url 'properties:detail' prop.pk %}" class="btn btn-sm btn-outline-secondary">View Details</a>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>
{% endif %}
<section class="mt-5">
  <div class="container text-center">
    <h2 class="fw-semibold mb-4 text-brown">Why Choose Grihaloy?</h2>
    <div class="row g-4">
      <div class="col-md-4">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-body">
            <h4>üè† Verified Properties</h4>
            <p class="text-muted">All listings are screened and verified for safety and accuracy.</p>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-body">
            <h4>ü§ù Trusted Tenants & Landlords</h4>
            <p class="text-muted">Transparent profiles and feedback system to ensure trust.</p>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-body">
            <h4>‚ö° Seamless Experience</h4>
            <p class="text-muted">Search, verify, and rent with just a few clicks ‚Äî hassle-free.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block styles %}
{# Optional: Add a subtle hover effect for the poster cards #}
<style>
.property-poster-card {
  transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
}
.property-poster-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 .5rem 1rem rgba(0,0,0,.15)!important;
}
</style>
{% endblock %}